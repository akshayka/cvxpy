
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Robust Kalman filtering for vehicle tracking &#8212; CVXPY 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/cvxpy_alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="robust-kalman-filtering-for-vehicle-tracking">
<h1>Robust Kalman filtering for vehicle tracking<a class="headerlink" href="#robust-kalman-filtering-for-vehicle-tracking" title="Permalink to this headline">¶</a></h1>
<p>We will try to pinpoint the location of a moving vehicle with high
accuracy from noisy sensor data. We’ll do this by modeling the vehicle
state as a discrete-time linear dynamical system. Standard <strong>Kalman
filtering</strong> can be used to approach this problem when the sensor noise
is assumed to be Gaussian. We’ll use <strong>robust Kalman filtering</strong> to get
a more accurate estimate of the vehicle state for a non-Gaussian case
with outliers.</p>
</div>
<div class="section" id="problem-statement">
<h1>Problem statement<a class="headerlink" href="#problem-statement" title="Permalink to this headline">¶</a></h1>
<p>A discrete-time linear dynamical system consists of a sequence of state
vectors <span class="math">\(x_t \in \mathbf{R}^n\)</span>, indexed by time
<span class="math">\(t \in \lbrace 0, \ldots, N-1 \rbrace\)</span> and dynamics equations</p>
<p>where <span class="math">\(w_t \in \mathbf{R}^m\)</span> is an input to the dynamical system
(say, a drive force on the vehicle), <span class="math">\(y_t \in \mathbf{R}^r\)</span> is a
state measurement, <span class="math">\(v_t \in \mathbf{R}^r\)</span> is noise, <span class="math">\(A\)</span> is
the drift matrix, <span class="math">\(B\)</span> is the input matrix, and <span class="math">\(C\)</span> is the
observation matrix.</p>
<p>Given <span class="math">\(A\)</span>, <span class="math">\(B\)</span>, <span class="math">\(C\)</span>, and <span class="math">\(y_t\)</span> for
<span class="math">\(t = 0, \ldots, N-1\)</span>, the goal is to estimate <span class="math">\(x_t\)</span> for
<span class="math">\(t = 0, \ldots, N-1\)</span>.</p>
</div>
<div class="section" id="kalman-filtering">
<h1>Kalman filtering<a class="headerlink" href="#kalman-filtering" title="Permalink to this headline">¶</a></h1>
<p>A Kalman filter estimates <span class="math">\(x_t\)</span> by solving the optimization
problem</p>
<p>where <span class="math">\(\tau\)</span> is a tuning parameter. This problem is actually a
least squares problem, and can be solved via linear algebra, without the
need for more general convex optimization. Note that since we have no
observation <span class="math">\(y_{N}\)</span>, <span class="math">\(x_N\)</span> is only constrained via
<span class="math">\(x_{N} = Ax_{N-1} + Bw_{N-1}\)</span>, which is trivially resolved when
<span class="math">\(w_{N-1} = 0\)</span> and <span class="math">\(x_{N} = Ax_{N-1}\)</span>. We maintain this
vestigial constraint only because it offers a concise problem statement.</p>
<p>This model performs well when <span class="math">\(w_t\)</span> and <span class="math">\(v_t\)</span> are Gaussian.
However, the quadratic objective can be influenced by large outliers,
which degrades the accuracy of the recovery. To improve estimation in
the presence of outliers, we can use <strong>robust Kalman filtering</strong>.</p>
</div>
<div class="section" id="robust-kalman-filtering">
<h1>Robust Kalman filtering<a class="headerlink" href="#robust-kalman-filtering" title="Permalink to this headline">¶</a></h1>
<p>To handle outliers in <span class="math">\(v_t\)</span>, robust Kalman filtering replaces the
quadratic cost with a Huber cost, which results in the convex
optimization problem</p>
<p>where <span class="math">\(\phi_\rho\)</span> is the Huber function</p>
<div class="math">
\[\begin{split}\phi_\rho(a)= \left\{ \begin{array}{ll} \|a\|_2^2 &amp; \|a\|_2\leq \rho\\
2\rho \|a\|_2-\rho^2 &amp; \|a\|_2&gt;\rho.
\end{array}\right.\end{split}\]</div>
<p>The Huber penalty function penalizes estimation error linearly outside
of a ball of radius <span class="math">\(\rho\)</span>, whereas in standard Kalman filtering,
all errors are penalized quadratically. Thus, large errors are penalized
less harshly, making this model more robust to outliers.</p>
</div>
<div class="section" id="vehicle-tracking-example">
<h1>Vehicle tracking example<a class="headerlink" href="#vehicle-tracking-example" title="Permalink to this headline">¶</a></h1>
<p>We’ll apply standard and robust Kalman filtering to a vehicle tracking
problem with state <span class="math">\(x_t \in \mathbf{R}^4\)</span>, where
<span class="math">\((x_{t,0}, x_{t,1})\)</span> is the position of the vehicle in two
dimensions, and <span class="math">\((x_{t,2}, x_{t,3})\)</span> is the vehicle velocity. The
vehicle has unknown drive force <span class="math">\(w_t\)</span>, and we observe noisy
measurements of the vehicle’s position, <span class="math">\(y_t \in \mathbf{R}^2\)</span>.</p>
<p>The matrices for the dynamics are</p>
<div class="math">
\[\begin{split}A = \begin{bmatrix}
1 &amp; 0 &amp; \left(1-\frac{\gamma}{2}\Delta t\right) \Delta t &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; \left(1-\frac{\gamma}{2} \Delta t\right) \Delta t\\
0 &amp; 0 &amp; 1-\gamma \Delta t &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1-\gamma \Delta t
\end{bmatrix},\end{split}\]</div>
<div class="math">
\[\begin{split}B = \begin{bmatrix}
\frac{1}{2}\Delta t^2 &amp; 0 \\
0 &amp; \frac{1}{2}\Delta t^2 \\
\Delta t &amp; 0 \\
0 &amp; \Delta t \\
\end{bmatrix},\end{split}\]</div>
<div class="math">
\[\begin{split}C = \begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 0
\end{bmatrix},\end{split}\]</div>
<p>where <span class="math">\(\gamma\)</span> is a velocity damping parameter.</p>
</div>
<div class="section" id="d-model">
<h1>1D Model<a class="headerlink" href="#d-model" title="Permalink to this headline">¶</a></h1>
<p>The recurrence is derived from the following relations in a single
dimension. For this subsection, let <span class="math">\(x_t, v_t, w_t\)</span> be the vehicle
position, velocity, and input drive force. The resulting acceleration of
the vehicle is <span class="math">\(w_t - \gamma v_t\)</span>, with <span class="math">\(- \gamma v_t\)</span> is a
damping term depending on velocity with parameter <span class="math">\(\gamma\)</span>.</p>
<p>The discretized dynamics are obtained from numerically integrating:</p>
<div class="math">
\[\begin{split}\begin{align}
x_{t+1} &amp;= x_t + \left(1-\frac{\gamma \Delta t}{2}\right)v_t \Delta t + \frac{1}{2}w_{t} \Delta t^2\\
v_{t+1} &amp;= \left(1-\gamma\right)v_t + w_t \Delta t.
\end{align}\end{split}\]</div>
<p>Extending these relations to two dimensions gives us the dynamics
matrices <span class="math">\(A\)</span> and <span class="math">\(B\)</span>.</p>
<div class="section" id="helper-functions">
<h2>Helper Functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">¶</a></h2>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">plot_state</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">actual</span><span class="p">,</span> <span class="n">estimated</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    plot position, speed, and acceleration in the x and y coordinates for</span>
<span class="sd">    the actual data, and optionally for the estimated data</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">trajectories</span> <span class="o">=</span> <span class="p">[</span><span class="n">actual</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">estimated</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">trajectories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">estimated</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">trajectories</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">,:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">,:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">,:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">,:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x position&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x velocity&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x input&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y position&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y velocity&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y input&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_positions</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    show point clouds for true, observed, and recovered positions</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">traj</span><span class="p">):</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">axis</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="problem-data">
<h2>Problem Data<a class="headerlink" href="#problem-data" title="Permalink to this headline">¶</a></h2>
<p>We generate the data for the vehicle tracking problem. We’ll have
<span class="math">\(N=1000\)</span>, <span class="math">\(w_t\)</span> a standard Gaussian, and <span class="math">\(v_t\)</span> a
standard Guassian, except <span class="math">\(20\%\)</span> of the points will be outliers
with <span class="math">\(\sigma = 20\)</span>.</p>
<p>Below, we set the problem parameters and define the matrices <span class="math">\(A\)</span>,
<span class="math">\(B\)</span>, and <span class="math">\(C\)</span>.</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># number of timesteps</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">50</span> <span class="c1"># time will vary from 0 to T with step delt</span>
<span class="n">ts</span><span class="p">,</span> <span class="n">delt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">retstep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="o">.</span><span class="mi">05</span> <span class="c1"># damping, 0 is no damping</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">gamma</span><span class="o">*</span><span class="n">delt</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">delt</span>
<span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">gamma</span><span class="o">*</span><span class="n">delt</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">delt</span>
<span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">gamma</span><span class="o">*</span><span class="n">delt</span>
<span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">gamma</span><span class="o">*</span><span class="n">delt</span>

<span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">delt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="n">B</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">delt</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="n">B</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">delt</span>
<span class="n">B</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">delt</span>

<span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="simulation">
<h1>Simulation<a class="headerlink" href="#simulation" title="Permalink to this headline">¶</a></h1>
<p>We seed <span class="math">\(x_0 = 0\)</span> (starting at the origin with zero velocity) and
simulate the system forward in time. The results are the true vehicle
positions <code class="docutils literal"><span class="pre">x_true</span></code> (which we will use to judge our recovery) and the
observed positions <code class="docutils literal"><span class="pre">y</span></code>.</p>
<p>We plot the position, velocity, and system input <span class="math">\(w\)</span> in both
dimensions as a function of time. We also plot the sets of true and
observed vehicle positions.</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">sigma</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">p</span> <span class="o">=</span> <span class="o">.</span><span class="mi">20</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">x</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>

<span class="c1"># generate random input and noise vectors</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>

<span class="c1"># add outliers to v</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">p</span>
<span class="n">v</span><span class="p">[:,</span><span class="n">inds</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigma</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span><span class="p">)[:,</span><span class="n">inds</span><span class="p">]</span>

<span class="c1"># simulate the system forward in time</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">y</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span><span class="n">t</span><span class="p">])</span> <span class="o">+</span> <span class="n">v</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span>
    <span class="n">x</span><span class="p">[:,</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span><span class="n">t</span><span class="p">])</span> <span class="o">+</span> <span class="n">B</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">w</span><span class="p">[:,</span><span class="n">t</span><span class="p">])</span>

<span class="n">x_true</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">w_true</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">plot_state</span><span class="p">(</span><span class="n">ts</span><span class="p">,(</span><span class="n">x_true</span><span class="p">,</span><span class="n">w_true</span><span class="p">))</span>
<span class="n">plot_positions</span><span class="p">([</span><span class="n">x_true</span><span class="p">,</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;True&#39;</span><span class="p">,</span> <span class="s1">&#39;Observed&#39;</span><span class="p">],[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s1">&#39;rkf1.pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/robust_kalman_6_0.png" src="../../_images/robust_kalman_6_0.png" />
<img alt="../../_images/robust_kalman_6_1.png" src="../../_images/robust_kalman_6_1.png" />
</div>
<div class="section" id="kalman-filtering-recovery">
<h1>Kalman filtering recovery<a class="headerlink" href="#kalman-filtering-recovery" title="Permalink to this headline">¶</a></h1>
<p>The code below solves the standard Kalman filtering problem using CVXPY.
We plot and compare the true and recovered vehicle states. Note that the
recovery is distorted by outliers in the measurements.</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">time</span>
<span class="kn">from</span> <span class="nn">cvxpy</span> <span class="k">import</span> <span class="o">*</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

<span class="n">tau</span> <span class="o">=</span> <span class="o">.</span><span class="mi">08</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">sum_squares</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="n">tau</span><span class="o">*</span><span class="n">sum_squares</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">Minimize</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

<span class="n">constr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">constr</span> <span class="o">+=</span> <span class="p">[</span> <span class="n">x</span><span class="p">[:,</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">A</span><span class="o">*</span><span class="n">x</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="n">w</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span> <span class="p">,</span>
                <span class="n">y</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span>   <span class="o">==</span> <span class="n">C</span><span class="o">*</span><span class="n">x</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span>   <span class="p">]</span>

<span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constr</span><span class="p">)</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="n">plot_state</span><span class="p">(</span><span class="n">ts</span><span class="p">,(</span><span class="n">x_true</span><span class="p">,</span><span class="n">w_true</span><span class="p">),(</span><span class="n">x</span><span class="p">,</span><span class="n">w</span><span class="p">))</span>
<span class="n">plot_positions</span><span class="p">([</span><span class="n">x_true</span><span class="p">,</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;True&#39;</span><span class="p">,</span> <span class="s1">&#39;Noisy&#39;</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">])</span>
<span class="n">plot_positions</span><span class="p">([</span><span class="n">x_true</span><span class="p">,</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;True&#39;</span><span class="p">,</span> <span class="s1">&#39;KF recovery&#39;</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span> <span class="s1">&#39;rkf2.pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>ECOS 1.0.4 - (c) A. Domahidi, Automatic Control Laboratory, ETH Zurich, 2012-2014.

It     pcost         dcost      gap     pres    dres     k/t     mu      step     IR
 0   +0.000e+00   -3.414e+00   +3e+03   5e+02   1e+00   1e+00   4e+02    N/A     1 1 -
 1   +3.287e+02   +3.646e+02   +4e+02   2e+02   5e-01   4e+01   7e+01   0.8666   2 2 2
 2   +9.613e+02   +1.284e+03   +2e+02   2e+02   7e-01   3e+02   3e+01   0.8524   3 2 2
 3   +3.398e+02   +5.369e+02   +1e+02   9e+01   3e-01   2e+02   2e+01   0.6979   2 2 2
 4   +6.031e+02   +8.107e+02   +2e+01   3e+01   1e-01   2e+02   3e+00   0.8582   2 2 1
 5   +1.344e+03   +2.462e+03   +8e+00   7e+01   2e-01   1e+03   1e+00   0.8006   3 2 1
 6   +2.830e+03   +3.316e+03   +1e+00   2e+01   5e-02   5e+02   2e-01   0.9639   2 2 2
 7   +2.686e+03   +2.896e+03   +6e-01   7e+00   2e-02   2e+02   9e-02   0.7906   3 2 2
 8   +5.190e+03   +7.816e+03   +3e-01   3e+01   8e-02   3e+03   4e-02   0.9228   2 3 2
 9   +4.379e+03   +5.386e+03   +2e-01   1e+01   4e-02   1e+03   3e-02   0.3498   3 2 2
10   +6.829e+03   +7.204e+03   +1e-02   1e+00   4e-03   4e+02   2e-03   0.9552   2 2 2
11   +8.845e+03   +9.140e+03   +4e-03   6e-01   2e-03   3e+02   6e-04   0.9002   3 3 3
12   +9.958e+03   +1.023e+04   +1e-03   3e-01   9e-04   3e+02   2e-04   0.9424   3 3 3
13   +1.070e+04   +1.077e+04   +3e-04   8e-02   2e-04   7e+01   6e-05   0.8269   3 3 3
14   +1.077e+04   +1.084e+04   +3e-04   7e-02   2e-04   7e+01   5e-05   0.4583   3 3 3
15   +1.104e+04   +1.104e+04   +1e-05   4e-03   1e-05   3e+00   2e-06   0.9622   3 3 3
16   +1.106e+04   +1.106e+04   +6e-07   1e-04   4e-07   9e-02   1e-07   0.9718   3 3 3
17   +1.106e+04   +1.106e+04   +8e-09   6e-05   6e-09   1e-03   1e-09   0.9873   2 2 2
18   +1.108e+04   +1.108e+04   -8e+14   -3e+13   -2e+01   -1e-03   -1e+14   0.0001   0 0 0
Unreliable search direction detected, recovering best iterate (17) and stopping.

Close to OPTIMAL (within feastol=6.3e-05, reltol=7.5e-13, abstol=8.3e-09).
Runtime: 0.232002 seconds.

CPU times: user 10.9 s, sys: 79.3 ms, total: 11 s
Wall time: 11.3 s
</pre></div>
</div>
<img alt="../../_images/robust_kalman_8_1.png" src="../../_images/robust_kalman_8_1.png" />
<img alt="../../_images/robust_kalman_8_2.png" src="../../_images/robust_kalman_8_2.png" />
<img alt="../../_images/robust_kalman_8_3.png" src="../../_images/robust_kalman_8_3.png" />
</div>
<div class="section" id="robust-kalman-filtering-recovery">
<h1>Robust Kalman filtering recovery<a class="headerlink" href="#robust-kalman-filtering-recovery" title="Permalink to this headline">¶</a></h1>
<p>Here we implement robust Kalman filtering with CVXPY. We get a better
recovery than the standard Kalman filtering, which can be seen in the
plots below.</p>
<div class="code highlight-default"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">time</span>
<span class="kn">from</span> <span class="nn">cvxpy</span> <span class="k">import</span> <span class="o">*</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

<span class="n">tau</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">sum_squares</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="n">obj</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">tau</span><span class="o">*</span><span class="n">huber</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">[:,</span><span class="n">t</span><span class="p">]),</span><span class="n">rho</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">Minimize</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

<span class="n">constr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">constr</span> <span class="o">+=</span> <span class="p">[</span> <span class="n">x</span><span class="p">[:,</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">A</span><span class="o">*</span><span class="n">x</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="n">w</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span> <span class="p">,</span>
                <span class="n">y</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span>   <span class="o">==</span> <span class="n">C</span><span class="o">*</span><span class="n">x</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[:,</span><span class="n">t</span><span class="p">]</span>   <span class="p">]</span>

<span class="n">Problem</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">constr</span><span class="p">)</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="n">plot_state</span><span class="p">(</span><span class="n">ts</span><span class="p">,(</span><span class="n">x_true</span><span class="p">,</span><span class="n">w_true</span><span class="p">),(</span><span class="n">x</span><span class="p">,</span><span class="n">w</span><span class="p">))</span>
<span class="n">plot_positions</span><span class="p">([</span><span class="n">x_true</span><span class="p">,</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;True&#39;</span><span class="p">,</span> <span class="s1">&#39;Noisy&#39;</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">])</span>
<span class="n">plot_positions</span><span class="p">([</span><span class="n">x_true</span><span class="p">,</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;True&#39;</span><span class="p">,</span> <span class="s1">&#39;Robust KF recovery&#39;</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s1">&#39;rkf3.pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ECOS</span> <span class="mf">1.0</span><span class="o">.</span><span class="mi">4</span> <span class="o">-</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="n">A</span><span class="o">.</span> <span class="n">Domahidi</span><span class="p">,</span> <span class="n">Automatic</span> <span class="n">Control</span> <span class="n">Laboratory</span><span class="p">,</span> <span class="n">ETH</span> <span class="n">Zurich</span><span class="p">,</span> <span class="mi">2012</span><span class="o">-</span><span class="mf">2014.</span>

<span class="n">It</span>     <span class="n">pcost</span>         <span class="n">dcost</span>      <span class="n">gap</span>     <span class="n">pres</span>    <span class="n">dres</span>     <span class="n">k</span><span class="o">/</span><span class="n">t</span>     <span class="n">mu</span>      <span class="n">step</span>     <span class="n">IR</span>
 <span class="mi">0</span>   <span class="o">+</span><span class="mf">0.000e+00</span>   <span class="o">-</span><span class="mf">2.850e+03</span>   <span class="o">+</span><span class="mi">2</span><span class="n">e</span><span class="o">+</span><span class="mi">06</span>   <span class="mi">1</span><span class="n">e</span><span class="o">+</span><span class="mi">02</span>   <span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">01</span>   <span class="mi">1</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span>   <span class="mi">3</span><span class="n">e</span><span class="o">+</span><span class="mi">02</span>    <span class="n">N</span><span class="o">/</span><span class="n">A</span>     <span class="mi">1</span> <span class="mi">1</span> <span class="o">-</span>
 <span class="mi">1</span>   <span class="o">+</span><span class="mf">3.189e+03</span>   <span class="o">+</span><span class="mf">1.216e+03</span>   <span class="o">+</span><span class="mi">2</span><span class="n">e</span><span class="o">+</span><span class="mi">06</span>   <span class="mi">8</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span>   <span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">01</span>   <span class="mi">9</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span>   <span class="mi">2</span><span class="n">e</span><span class="o">+</span><span class="mi">02</span>   <span class="mf">0.5782</span>   <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
 <span class="mi">2</span>   <span class="o">+</span><span class="mf">4.398e+03</span>   <span class="o">+</span><span class="mf">4.036e+03</span>   <span class="o">+</span><span class="mi">3</span><span class="n">e</span><span class="o">+</span><span class="mi">05</span>   <span class="mi">2</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span>   <span class="mi">3</span><span class="n">e</span><span class="o">-</span><span class="mi">02</span>   <span class="mi">2</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span>   <span class="mi">5</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span>   <span class="mf">0.8069</span>   <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
 <span class="mi">3</span>   <span class="o">+</span><span class="mf">1.564e+04</span>   <span class="o">+</span><span class="mf">1.539e+04</span>   <span class="o">+</span><span class="mi">2</span><span class="n">e</span><span class="o">+</span><span class="mi">05</span>   <span class="mi">1</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span>   <span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">02</span>   <span class="mi">2</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span>   <span class="mi">3</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span>   <span class="mf">0.5374</span>   <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
 <span class="mi">4</span>   <span class="o">+</span><span class="mf">2.547e+04</span>   <span class="o">+</span><span class="mf">2.537e+04</span>   <span class="o">+</span><span class="mi">9</span><span class="n">e</span><span class="o">+</span><span class="mi">04</span>   <span class="mi">4</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span>   <span class="mi">9</span><span class="n">e</span><span class="o">-</span><span class="mi">03</span>   <span class="mi">1</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span>   <span class="mi">1</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span>   <span class="mf">0.6977</span>   <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span>
 <span class="mi">5</span>   <span class="o">+</span><span class="mf">3.019e+04</span>   <span class="o">+</span><span class="mf">3.014e+04</span>   <span class="o">+</span><span class="mi">4</span><span class="n">e</span><span class="o">+</span><span class="mi">04</span>   <span class="mi">2</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span>   <span class="mi">4</span><span class="n">e</span><span class="o">-</span><span class="mi">03</span>   <span class="mi">6</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span>   <span class="mi">6</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span>   <span class="mf">0.6786</span>   <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span>
 <span class="mi">6</span>   <span class="o">+</span><span class="mf">3.356e+04</span>   <span class="o">+</span><span class="mf">3.353e+04</span>   <span class="o">+</span><span class="mi">2</span><span class="n">e</span><span class="o">+</span><span class="mi">04</span>   <span class="mi">1</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span>   <span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">03</span>   <span class="mi">3</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span>   <span class="mi">3</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span>   <span class="mf">0.6066</span>   <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span>
 <span class="mi">7</span>   <span class="o">+</span><span class="mf">3.528e+04</span>   <span class="o">+</span><span class="mf">3.526e+04</span>   <span class="o">+</span><span class="mi">1</span><span class="n">e</span><span class="o">+</span><span class="mi">04</span>   <span class="mi">6</span><span class="n">e</span><span class="o">-</span><span class="mi">01</span>   <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">03</span>   <span class="mi">2</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span>   <span class="mi">2</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span>   <span class="mf">0.6694</span>   <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span>
 <span class="mi">8</span>   <span class="o">+</span><span class="mf">3.673e+04</span>   <span class="o">+</span><span class="mf">3.672e+04</span>   <span class="o">+</span><span class="mi">6</span><span class="n">e</span><span class="o">+</span><span class="mi">03</span>   <span class="mi">3</span><span class="n">e</span><span class="o">-</span><span class="mi">01</span>   <span class="mi">6</span><span class="n">e</span><span class="o">-</span><span class="mi">04</span>   <span class="mi">1</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span>   <span class="mi">9</span><span class="n">e</span><span class="o">-</span><span class="mi">01</span>   <span class="mf">0.7467</span>   <span class="mi">3</span> <span class="mi">1</span> <span class="mi">1</span>
 <span class="mi">9</span>   <span class="o">+</span><span class="mf">3.807e+04</span>   <span class="o">+</span><span class="mf">3.807e+04</span>   <span class="o">+</span><span class="mi">2</span><span class="n">e</span><span class="o">+</span><span class="mi">03</span>   <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">01</span>   <span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">04</span>   <span class="mi">4</span><span class="n">e</span><span class="o">-</span><span class="mi">01</span>   <span class="mi">3</span><span class="n">e</span><span class="o">-</span><span class="mi">01</span>   <span class="mf">0.8736</span>   <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">10</span>   <span class="o">+</span><span class="mf">3.887e+04</span>   <span class="o">+</span><span class="mf">3.887e+04</span>   <span class="o">+</span><span class="mi">4</span><span class="n">e</span><span class="o">+</span><span class="mi">02</span>   <span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">02</span>   <span class="mi">4</span><span class="n">e</span><span class="o">-</span><span class="mi">05</span>   <span class="mi">7</span><span class="n">e</span><span class="o">-</span><span class="mi">02</span>   <span class="mi">6</span><span class="n">e</span><span class="o">-</span><span class="mi">02</span>   <span class="mf">0.9156</span>   <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">11</span>   <span class="o">+</span><span class="mf">3.901e+04</span>   <span class="o">+</span><span class="mf">3.901e+04</span>   <span class="o">+</span><span class="mi">1</span><span class="n">e</span><span class="o">+</span><span class="mi">02</span>   <span class="mi">7</span><span class="n">e</span><span class="o">-</span><span class="mi">03</span>   <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">05</span>   <span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">02</span>   <span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">02</span>   <span class="mf">0.8073</span>   <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">12</span>   <span class="o">+</span><span class="mf">3.905e+04</span>   <span class="o">+</span><span class="mf">3.905e+04</span>   <span class="o">+</span><span class="mi">5</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span>   <span class="mi">3</span><span class="n">e</span><span class="o">-</span><span class="mi">03</span>   <span class="mi">6</span><span class="n">e</span><span class="o">-</span><span class="mi">06</span>   <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">02</span>   <span class="mi">7</span><span class="n">e</span><span class="o">-</span><span class="mi">03</span>   <span class="mf">0.7572</span>   <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">13</span>   <span class="o">+</span><span class="mf">3.907e+04</span>   <span class="o">+</span><span class="mf">3.907e+04</span>   <span class="o">+</span><span class="mi">2</span><span class="n">e</span><span class="o">+</span><span class="mi">01</span>   <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">03</span>   <span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">06</span>   <span class="mi">4</span><span class="n">e</span><span class="o">-</span><span class="mi">03</span>   <span class="mi">3</span><span class="n">e</span><span class="o">-</span><span class="mi">03</span>   <span class="mf">0.8667</span>   <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">14</span>   <span class="o">+</span><span class="mf">3.908e+04</span>   <span class="o">+</span><span class="mf">3.908e+04</span>   <span class="o">+</span><span class="mi">4</span><span class="n">e</span><span class="o">+</span><span class="mi">00</span>   <span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">04</span>   <span class="mi">5</span><span class="n">e</span><span class="o">-</span><span class="mi">07</span>   <span class="mi">8</span><span class="n">e</span><span class="o">-</span><span class="mi">04</span>   <span class="mi">6</span><span class="n">e</span><span class="o">-</span><span class="mi">04</span>   <span class="mf">0.9865</span>   <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">15</span>   <span class="o">+</span><span class="mf">3.908e+04</span>   <span class="o">+</span><span class="mf">3.908e+04</span>   <span class="o">+</span><span class="mi">5</span><span class="n">e</span><span class="o">-</span><span class="mi">01</span>   <span class="mi">3</span><span class="n">e</span><span class="o">-</span><span class="mi">05</span>   <span class="mi">5</span><span class="n">e</span><span class="o">-</span><span class="mi">08</span>   <span class="mi">8</span><span class="n">e</span><span class="o">-</span><span class="mi">05</span>   <span class="mi">6</span><span class="n">e</span><span class="o">-</span><span class="mi">05</span>   <span class="mf">0.8989</span>   <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">16</span>   <span class="o">+</span><span class="mf">3.908e+04</span>   <span class="o">+</span><span class="mf">3.908e+04</span>   <span class="o">+</span><span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">01</span>   <span class="mi">6</span><span class="n">e</span><span class="o">-</span><span class="mi">06</span>   <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">08</span>   <span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">05</span>   <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">05</span>   <span class="mf">0.9899</span>   <span class="mi">3</span> <span class="mi">2</span> <span class="mi">2</span>
<span class="mi">17</span>   <span class="o">+</span><span class="mf">3.908e+04</span>   <span class="o">+</span><span class="mf">3.908e+04</span>   <span class="o">+</span><span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">02</span>   <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">06</span>   <span class="mi">2</span><span class="n">e</span><span class="o">-</span><span class="mi">09</span>   <span class="mi">3</span><span class="n">e</span><span class="o">-</span><span class="mi">06</span>   <span class="mi">3</span><span class="n">e</span><span class="o">-</span><span class="mi">06</span>   <span class="mf">0.8616</span>   <span class="mi">3</span> <span class="mi">2</span> <span class="mi">2</span>
<span class="mi">18</span>   <span class="o">+</span><span class="mf">3.908e+04</span>   <span class="o">+</span><span class="mf">3.908e+04</span>   <span class="o">+</span><span class="mi">7</span><span class="n">e</span><span class="o">-</span><span class="mi">03</span>   <span class="mi">4</span><span class="n">e</span><span class="o">-</span><span class="mi">07</span>   <span class="mi">7</span><span class="n">e</span><span class="o">-</span><span class="mi">10</span>   <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">06</span>   <span class="mi">9</span><span class="n">e</span><span class="o">-</span><span class="mi">07</span>   <span class="mf">0.9899</span>   <span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span>
<span class="mi">19</span>   <span class="o">+</span><span class="mf">3.908e+04</span>   <span class="o">+</span><span class="mf">3.908e+04</span>   <span class="o">+</span><span class="mi">6</span><span class="n">e</span><span class="o">-</span><span class="mi">04</span>   <span class="mi">4</span><span class="n">e</span><span class="o">-</span><span class="mi">08</span>   <span class="mi">6</span><span class="n">e</span><span class="o">-</span><span class="mi">11</span>   <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">07</span>   <span class="mi">8</span><span class="n">e</span><span class="o">-</span><span class="mi">08</span>   <span class="mf">0.9423</span>   <span class="mi">3</span> <span class="mi">1</span> <span class="mi">2</span>

<span class="n">OPTIMAL</span> <span class="p">(</span><span class="n">within</span> <span class="n">feastol</span><span class="o">=</span><span class="mf">3.6e-08</span><span class="p">,</span> <span class="n">reltol</span><span class="o">=</span><span class="mf">1.5e-08</span><span class="p">,</span> <span class="n">abstol</span><span class="o">=</span><span class="mf">5.7e-04</span><span class="p">)</span><span class="o">.</span>
<span class="n">Runtime</span><span class="p">:</span> <span class="mf">0.363771</span> <span class="n">seconds</span><span class="o">.</span>

<span class="n">CPU</span> <span class="n">times</span><span class="p">:</span> <span class="n">user</span> <span class="mf">28.6</span> <span class="n">s</span><span class="p">,</span> <span class="n">sys</span><span class="p">:</span> <span class="mf">77.1</span> <span class="n">ms</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="mf">28.6</span> <span class="n">s</span>
<span class="n">Wall</span> <span class="n">time</span><span class="p">:</span> <span class="mf">29.4</span> <span class="n">s</span>
</pre></div>
</div>
<img alt="../../_images/robust_kalman_10_1.png" src="../../_images/robust_kalman_10_1.png" />
<img alt="../../_images/robust_kalman_10_2.png" src="../../_images/robust_kalman_10_2.png" />
<img alt="../../_images/robust_kalman_10_3.png" src="../../_images/robust_kalman_10_3.png" />
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">CVXPY</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=cvxgrp&repo=cvxpy&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a href="https://travis-ci.org/cvxgrp/cvxpy">
    <img
        alt="https://secure.travis-ci.org/cvxgrp/cvxpy.svg?branch=master"
        src="https://secure.travis-ci.org/cvxgrp/cvxpy.svg?branch=master"
    />
</a>
</p>


<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install/index.html">Install Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">Tutorial</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api_reference/cvxpy.html">API Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">FAQ</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../citing/index.html">Citing CVXPY</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../updates/index.html">What’s New in CVXPY 1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Contributing</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../related_projects/index.html">Related Projects</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Steven Diamond, Eric Chu, Akshay Agrawal, Stephen Boyd.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../../_sources/examples/applications/robust_kalman.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/cvxgrp/cvxpy" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-50248335-1']);
      _gaq.push(['_setDomainName', 'none']);
      _gaq.push(['_setAllowLinker', true]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    
  </body>
</html>